#  Работа с репозиторием (локальная в контейнерах!)

- клонируйте репозиторий
```
git clone git@github.com:vink-bot/backend.git
```

- Запустите docker локально. Затем введите команды
```
docker-compose up --build
```

- Перейдите в контейнер backend (например через локальный докер в визуальном режиме), создайте миграции, примените миграции, создайте суперюзера.
```
python manage.py makemigrations
python manage.py migrate
python manage.py createsuperuser
```

- Swagger RESTful API Documentation Specification будет доступен по url:
http://127.0.0.1:8000/swagger/
- API (version 1) будет доступен по url:
http://127.0.0.1:8000/api/v1/
- Админка будет доступна по url:
http://127.0.0.1:8000/admin/
- Flower(отслеживание задач celery) будет доступty по url:
http://127.0.0.1:5555

- Логика
Фронт отправляет POST запрос на http://127.0.0.1:8000/gpt/ передает в теле запроса сообщение от пользователя, например
{
    "message": "Торгуете?"
}
и в Headers передает токен пользователя (токен генерит фронт), например
{
    "chat-token": "serw45ge45v45ygv45yb5454"
}
Создается запись в таблице Message с сообщением пользователя и таблице Token(если его ранее не было)
Фронт получает сразу ответ 201 либо 400. И задача улетает в celery-worker. Там данное сообщение отправляем в yandexGPT и получаем ответ. Создается запись в таблице Message с сообщением от GPT.
Фронт шлет периодически GET запрос на http://127.0.0.1:8000/message/ в Headers передает токен пользователя.
По токену достаем все сообщения со status = "0" и отдаем их фронту в виде
{
    "messages": [
        {
            "message": "Могу предложить вам список товаров синего цвета, которые есть на нашем сайте. Чтобы увидеть полный ассортимент и характеристики товаров, перейдите на страницу конкретного товара, нажав на ссылку рядом с его названием.\n\n* Бумага для плоттера HP 400 г/м², цвет: синий.\n* Пленка самоклеящаяся (монтажная) 35 мм, цвет: темно-синий.\n* Самоклеящаяся пленка ПВХ для плоттера 36 мм, цвет: голубой.\n* Вощеная бумага рулон 300 мм, цвет: тёмно-синий. \n* Термоклей-карандаш 11 мм для печати на текстиле, цвет: морской.\n* Каплесборник для плоттера, цвет: прозрачный синий.\n\nЕсли у вас появятся дополнительные вопросы, вы можете задать их нам.",
            "date_create": "2024-04-01T10:10:19.109995Z",
            "user": "GPT"
        },
        {
            "message": "Да, мы торгуем такими товарами.\n\nДля того, чтобы получить консультацию по наличию интересующего вас товара, узнать цену и оформить заказ, пожалуйста, свяжитесь с нашей службой поддержки по телефону или через форму обратной связи на нашем сайте. Наши специалисты ответят вам в ближайшее время.",
            "date_create": "2024-04-01T10:10:32.014938Z",
            "user": "GPT"
        }
    ]
}

# vink_backend
Разработка чат-бота с технологией GPT на сайт компании для предоставления консультаций по материалам и оборудованию, а также оказания помощи клиентам 24/7.

# сервер
IP для входа на сервер  - 77.232.128.89